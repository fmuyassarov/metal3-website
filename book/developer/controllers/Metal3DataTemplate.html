<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Metal3DataTemplate - Metal³ Book</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../favicon.png">
        
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../../overview/project-overview.html"><strong aria-hidden="true">1.</strong> Project Overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../overview/metal3-components.html"><strong aria-hidden="true">1.1.</strong> Metal³ Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../overview/capm3/capm3.html"><strong aria-hidden="true">1.1.1.</strong> Cluster-Api-Provider-Metal³</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../overview/capm3/workflow.html"><strong aria-hidden="true">1.1.1.1.</strong> Workflow</a></li><li class="chapter-item expanded "><a href="../../overview/capm3/api.html"><strong aria-hidden="true">1.1.1.2.</strong> API concepts</a></li></ol></li><li class="chapter-item expanded "><a href="../../overview/bmo/bmo.html"><strong aria-hidden="true">1.1.2.</strong> Baremetal Operator</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../overview/bmo/ironic-integration.html"><strong aria-hidden="true">1.1.2.1.</strong> Ironic Integration</a></li><li class="chapter-item expanded "><a href="../../overview/bmo/bmh-states.html"><strong aria-hidden="true">1.1.2.2.</strong> BaremetalHost Provisioning States</a></li><li class="chapter-item expanded "><a href="../../overview/bmo/workflow.html"><strong aria-hidden="true">1.1.2.3.</strong> Workflow</a></li><li class="chapter-item expanded "><a href="../../overview/bmo/api.html"><strong aria-hidden="true">1.1.2.4.</strong> API concepts</a></li></ol></li><li class="chapter-item expanded "><a href="../../overview/metal3-dev-env.html"><strong aria-hidden="true">1.1.3.</strong> Metal³-Dev-Env</a></li><li class="chapter-item expanded "><a href="../../overview/ipam/ip-address-manager.html"><strong aria-hidden="true">1.1.4.</strong> Ip-Address-Manager</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../overview/ipam/workflow.html"><strong aria-hidden="true">1.1.4.1.</strong> Workflow</a></li><li class="chapter-item expanded "><a href="../../overview/ipam/api.html"><strong aria-hidden="true">1.1.4.2.</strong> API concepts</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../developer/developer-guide.html"><strong aria-hidden="true">2.</strong> Developer Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../developer/testing.html"><strong aria-hidden="true">2.1.</strong> Testing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../developer/testing/metal3-dev-env.html"><strong aria-hidden="true">2.1.1.</strong> Metal³-Dev-Env</a></li><li class="chapter-item expanded "><a href="../../developer/testing/tilt.html"><strong aria-hidden="true">2.1.2.</strong> Tilt</a></li></ol></li><li class="chapter-item expanded "><a href="../../developer/contollers.html"><strong aria-hidden="true">2.2.</strong> Custom Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../developer/controllers/Metal3Cluster.html"><strong aria-hidden="true">2.2.1.</strong> Metal3Cluster</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/Metal3Machine.html"><strong aria-hidden="true">2.2.2.</strong> Metal3Machine</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/BareMetalHost.html"><strong aria-hidden="true">2.2.3.</strong> BareMetalHost</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/Metal3MachineTemplate.html"><strong aria-hidden="true">2.2.4.</strong> Metal3MachineTemplate</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/IpPool.html"><strong aria-hidden="true">2.2.5.</strong> IpPool</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/IpClaim.html"><strong aria-hidden="true">2.2.6.</strong> IpClaim</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/IpAddress.html"><strong aria-hidden="true">2.2.7.</strong> IpAddress</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/Metal3Data.html"><strong aria-hidden="true">2.2.8.</strong> Metal3Data</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/Metal3DataClaim.html"><strong aria-hidden="true">2.2.9.</strong> Metal3DataClaim</a></li><li class="chapter-item expanded "><a href="../../developer/controllers/Metal3DataTemplate.html" class="active"><strong aria-hidden="true">2.2.10.</strong> Metal3DataTemplate</a></li></ol></li><li class="chapter-item expanded "><a href="../../developer/relational_diagram.html"><strong aria-hidden="true">2.3.</strong> Custom Resource Relational Diagram</a></li></ol></li><li class="chapter-item expanded "><a href="../../references/references.html"><strong aria-hidden="true">3.</strong> References</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../references/glossary.html"><strong aria-hidden="true">3.1.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../../references/code-of-conduct.html"><strong aria-hidden="true">3.2.</strong> Code of Conduct</a></li><li class="chapter-item expanded "><a href="../../references/contribution.html"><strong aria-hidden="true">3.3.</strong> Contribution</a></li><li class="chapter-item expanded "><a href="../../references/roadmap.html"><strong aria-hidden="true">3.4.</strong> Roadmap</a></li></ol></li><li class="chapter-item expanded "><a href="../../mdbook.html"><strong aria-hidden="true">4.</strong> Multi-repo Test with Mdbook</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../submodules/bmo/docs/api.html"><strong aria-hidden="true">4.1.</strong> BMO</a></li><li class="chapter-item expanded "><a href="../../submodules/capm3/docs/api.html"><strong aria-hidden="true">4.2.</strong> CAPM3</a></li><li class="chapter-item expanded "><a href="../../submodules/dev-env/index.html"><strong aria-hidden="true">4.3.</strong> Metal3-dev-env</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Metal³ Book</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        <a href="https://github.com/metal3-io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#metal3datatemplate" id="metal3datatemplate">Metal3DataTemplate</a></h1>
<h2><a class="header" href="#metal3datatemplate-example" id="metal3datatemplate-example">Metal3DataTemplate example</a></h2>
<pre><code class="language-yaml">apiVersion: infrastructure.cluster.x-k8s.io/v1alpha4
kind: Metal3DataTemplate
metadata:
  name: nodepool-1
  namespace: default
  ownerReferences:
  - apiVersion: infrastructure.cluster.x-k8s.io/v1alpha4
    controller: true
    kind: Metal3Cluster
    name: cluster-1
spec:
  metaData:
    strings:
      - key: abc
        value: def
    objectNames:
      - key: name_m3m
        object: metal3machine
      - key: name_machine
        object: machine
      - key: name_bmh
        object: baremetalhost
    indexes:
      - key: index
        offset: 0
        step: 1
    ipAddressesFromIPPool:
      - key: ip
        Name: pool-1
    prefixesFromIPPool:
      - key: ip
        Name: pool-1
    gatewaysFromIPPool:
      - key: gateway
        Name: pool-1
    dnsServersFromIPPool:
      - key: dns
        Name: pool-1
    fromHostInterfaces:
      - key: mac
        interface: &quot;eth0&quot;
    fromLabels:
      - key: label-1
        object: machine
        label: mylabelkey
    fromAnnotations:
      - key: annotation-1
        object: machine
        annotation: myannotationkey
  networkData:
    links:
      ethernets:
        - type: &quot;phy&quot;
          id: &quot;enp1s0&quot;
          mtu: 1500
          macAddress:
            fromHostInterface: &quot;eth0&quot;
        - type: &quot;phy&quot;
          id: &quot;enp2s0&quot;
          mtu: 1500
          macAddress:
            fromHostInterface: &quot;eth1&quot;
      bonds:
        - id: &quot;bond0&quot;
          mtu: 1500
          macAddress:
            string: &quot;XX:XX:XX:XX:XX:XX&quot;
          bondMode: &quot;802.1ad&quot;
          bondLinks:
            - enp1s0
            - enp2s0
      vlans:
        - id: &quot;vlan1&quot;
          mtu: 1500
          macAddress:
            string: &quot;YY:YY:YY:YY:YY:YY&quot;
          vlanId: 1
          vlanLink: bond0
    networks:
      ipv4DHCP:
        - id: &quot;provisioning&quot;
          link: &quot;bond0&quot;

      ipv4:
        - id: &quot;Baremetal&quot;
          link: &quot;vlan1&quot;
          IPAddressFromIPPool: pool-1
          routes:
            - network: &quot;0.0.0.0&quot;
              netmask: 0
              gateway:
                fromIPPool: pool-1
              services:
                dns:
                  - &quot;8.8.4.4&quot;
                dnsFromIPPool: pool-1
      ipv6DHCP:
        - id: &quot;provisioning6&quot;
          link: &quot;bond0&quot;
      ipv6SLAAC:
        - id: &quot;provisioning6slaac&quot;
          link: &quot;bond0&quot;
      ipv6:
        - id: &quot;Baremetal6&quot;
          link: &quot;vlan1&quot;
          IPAddressFromIPPool: pool6-1
          routes:
            - network: &quot;0::0&quot;
              netmask: 0
              gateway:
                string: &quot;2001:0db8:85a3::8a2e:0370:1&quot;
              services:
                dns:
                  - &quot;2001:4860:4860::8844&quot;
                dnsFromIPPool: pool6-1
    services:
      dns:
        - &quot;8.8.8.8&quot;
        - &quot;2001:4860:4860::8888&quot;
status:
  indexes:
    &quot;0&quot;: &quot;machine-1&quot;
  dataNames:
    &quot;machine-1&quot;: nodepool-1-0
  lastUpdated: &quot;2020-04-02T06:36:09Z&quot;
</code></pre>
<h2><a class="header" href="#metal3datatemplate-specmetadata" id="metal3datatemplate-specmetadata">Metal3DataTemplate spec.metaData</a></h2>
<h4><a class="header" href="#strings" id="strings">strings</a></h4>
<p>Renders the given string as value in the metadata. It takes a
<code>value</code> attribute.</p>
<h4><a class="header" href="#objectnames" id="objectnames">objectNames</a></h4>
<p>Renders the name of the object that matches the type given.
It takes an <code>object</code> attribute, containing the type of the object.</p>
<h4><a class="header" href="#indexes" id="indexes">indexes</a></h4>
<p>Renders the index of the current object, with the offset from the
<code>offset</code> field and using the step from the <code>step</code> field. The following
conditions must be matched : <code>offset</code> &gt;= 0 and <code>step</code> &gt;= 1
if the step is unspecified (default value being 0), the controller will
automatically change it for 1. The <code>prefix</code> and <code>suffix</code> attributes are to
provide a prefix and a suffix for the rendered index.</p>
<h4><a class="header" href="#ipaddressesfromippool" id="ipaddressesfromippool">ipAddressesFromIPPool</a></h4>
<p>Renders an ip address from an <em>IPPool</em>
object. The <em>IPPool</em> objects are defined in the
<a href="https://github.com/metal3-io/ip-address-manager">IP Address manager repo</a></p>
<h4><a class="header" href="#prefixesfromippool" id="prefixesfromippool">prefixesFromIPPool</a></h4>
<p>Renders a network prefix from an <em>IPPool</em>
object. The <em>IPPool</em> objects are defined in the
<a href="https://github.com/metal3-io/ip-address-manager">IP Address manager repo</a></p>
<h4><a class="header" href="#gatewaysfromippool" id="gatewaysfromippool">gatewaysFromIPPool</a></h4>
<p>Renders a network gateway from an <em>IPPool</em>
object. The <em>IPPool</em> objects are defined in the
<a href="https://github.com/metal3-io/ip-address-manager">IP Address manager repo</a></p>
<h4><a class="header" href="#dnsserversfromippool" id="dnsserversfromippool">dnsServersFromIPPool</a></h4>
<p>Renders a dns servers list from an <em>IPPool</em>
object. The <em>IPPool</em> objects are defined in the
<a href="https://github.com/metal3-io/ip-address-manager">IP Address manager repo</a></p>
<h4><a class="header" href="#fromhostinterfaces" id="fromhostinterfaces">fromHostInterfaces</a></h4>
<p>Renders the MAC address of the BareMetalHost that
matches the name given as value.</p>
<h4><a class="header" href="#fromlabels" id="fromlabels">fromLabels</a></h4>
<p>Renders the content of a label on an object or an empty string
if the label is absent. It takes an <code>object</code> attribute to specify the type of
the object where to fetch the label, and a <code>label</code> attribute that contains the
label key.</p>
<h4><a class="header" href="#fromannotations" id="fromannotations">fromAnnotations</a></h4>
<p>Renders the content of a annotation on an object or an
empty string if the annotation is absent. It takes an <code>object</code> attribute to
specify the type of the object where to fetch the annotation, and an
<code>annotation</code> attribute that contains the annotation key.</p>
<p>For each object, the attribute <strong>key</strong> is required.</p>
<h3><a class="header" href="#metal3datatemplate-specnetworkdata" id="metal3datatemplate-specnetworkdata">Metal3DataTemplate spec.networkData</a></h3>
<p>The <code>networkData</code> field will contain three items :</p>
<ul>
<li><strong>links</strong>: a list of layer 2 interface</li>
<li><strong>networks</strong>: a list of layer 3 networks</li>
<li><strong>services</strong> : a list of services (DNS)</li>
</ul>
<h4><a class="header" href="#links-specifications" id="links-specifications">Links specifications</a></h4>
<p>The object for the <strong>links</strong> section list can be:</p>
<ul>
<li><strong>ethernets</strong>: a list of ethernet interfaces</li>
<li><strong>bonds</strong>: a list of bond interfaces</li>
<li><strong>vlans</strong>: a list of vlan interfaces</li>
</ul>
<p>The <strong>links/ethernets</strong> objects contain the following:</p>
<ul>
<li><strong>type</strong>: Type of the ethernet interface</li>
<li><strong>id</strong>: Interface name</li>
<li><strong>mtu</strong>: Interface MTU</li>
<li><strong>macAddress</strong>: an object to render the MAC Address</li>
</ul>
<p>The <strong>links/ethernets/type</strong> can be one of :</p>
<ul>
<li>bridge</li>
<li>dvs</li>
<li>hw_veb</li>
<li>hyperv</li>
<li>ovs</li>
<li>tap</li>
<li>vhostuser</li>
<li>vif</li>
<li>phy</li>
</ul>
<p>The <strong>links/ethernets/macAddress</strong> object can be one of:</p>
<ul>
<li><strong>string</strong>: with the desired Mac given as a string</li>
<li><strong>fromHostInterface</strong>: with the interface name from BareMetalHost
hardware details.</li>
</ul>
<p>The <strong>links/bonds</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: Interface name</li>
<li><strong>mtu</strong>: Interface MTU</li>
<li><strong>macAddress</strong>: an object to render the MAC Address</li>
<li><strong>bondMode</strong>: The bond mode</li>
<li><strong>bondLinks</strong> : a list of links to use for the bond</li>
</ul>
<p>The <strong>links/bonds/bondMode</strong> can be one of :</p>
<ul>
<li>802.1ad</li>
<li>balance-rr</li>
<li>active-backup</li>
<li>balance-xor</li>
<li>broadcast</li>
<li>balance-tlb</li>
<li>balance-alb</li>
</ul>
<p>The <strong>links/vlans</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: Interface name</li>
<li><strong>mtu</strong>: Interface MTU</li>
<li><strong>macAddress</strong>: an object to render the MAC Address</li>
<li><strong>vlanId</strong>: The vlan ID</li>
<li><strong>vlanLink</strong> : The link on which to create the vlan</li>
</ul>
<h4><a class="header" href="#the-networks-specifications" id="the-networks-specifications">The networks specifications</a></h4>
<p>The object for the <strong>networks</strong> section can be:</p>
<ul>
<li><strong>ipv4</strong>: a list of ipv4 static allocations</li>
<li><strong>ipv4DHCP</strong>: a list of ipv4 DHCP based allocations</li>
<li><strong>ipv6</strong>: a list of ipv6 static allocations</li>
<li><strong>ipv6DHCP</strong>: a list of ipv6 DHCP based allocations</li>
<li><strong>ipv6SLAAC</strong>: a list of ipv6 SLAAC based allocations</li>
</ul>
<p>The <strong>networks/ipv4</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: the network name</li>
<li><strong>link</strong>: The name of the link to configure this network for</li>
<li><strong>ipAddressFromIPPool</strong>: renders an ip address from an <em>IPPool</em>
object. The <em>IPPool</em> objects are defined in the
<a href="https://github.com/metal3-io/ip-address-manager">IP Address manager repo</a></li>
<li><strong>routes</strong>: the list of route objects</li>
</ul>
<p>The <em><em>networks/ipv</em>/routes</em>* is a route object containing:</p>
<ul>
<li><strong>network</strong>: the subnet to reach</li>
<li><strong>netmask</strong>: the mask of the subnet as integer</li>
<li><strong>gateway</strong>: the gateway to use, it can either be given as a string in
<em>string</em> or as an IPPool name in <em>fromIPPool</em></li>
<li><strong>services</strong>: a list of services object as defined later</li>
</ul>
<p>The <strong>networks/ipv4Dhcp</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: the network name</li>
<li><strong>link</strong>: The name of the link to configure this network for</li>
<li><strong>routes</strong>: the list of route objects</li>
</ul>
<p>The <strong>networks/ipv6</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: the network name</li>
<li><strong>link</strong>: The name of the link to configure this network for</li>
<li><strong>ipAddressFromIPPool</strong>: renders an ip address from an <em>IPPool</em>
object. The <em>IPPool</em> objects are defined in the
<a href="https://github.com/metal3-io/ip-address-manager">IP Address manager repo</a></li>
<li><strong>routes</strong>: the list of route objects</li>
</ul>
<p>The <strong>networks/ipv6Dhcp</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: the network name</li>
<li><strong>link</strong>: The name of the link to configure this network for</li>
<li><strong>routes</strong>: the list of route objects</li>
</ul>
<p>The <strong>networks/ipv6Slaac</strong> object contains the following:</p>
<ul>
<li><strong>id</strong>: the network name</li>
<li><strong>link</strong>: The name of the link to configure this network for</li>
<li><strong>routes</strong>: the list of route objects</li>
</ul>
<h4><a class="header" href="#the-services-specifications" id="the-services-specifications">the services specifications</a></h4>
<p>The object for the <strong>services</strong> section can be:</p>
<ul>
<li><strong>dns</strong>: a list of dns service with the ip address of a dns server</li>
<li><strong>dnsFromIPPool</strong>: the IPPool from which to fetch the dns servers list</li>
</ul>
<h3><a class="header" href="#the-generated-secrets" id="the-generated-secrets">The generated secrets</a></h3>
<p>The name of the secret will be made of a prefix and the index. The Metal3Machine
object name will be used as the prefix. A <code>-metadata-</code> or <code>-networkdata-</code> will
be added between the prefix and the index.</p>
<h2><a class="header" href="#deployment-flow" id="deployment-flow">Deployment flow</a></h2>
<h3><a class="header" href="#manual-secret-creation" id="manual-secret-creation">Manual secret creation</a></h3>
<p>In the case where the Metal3Machine is created without a <code>dataTemplate</code> value,
if the <code>metaData</code> or <code>networkData</code> fields are set (one or both), the
Metal3Machine reconciler will fetch the secret, set the status field and
directly start the provisioning of the BareMetalHost using the secrets if given.
If one of the secrets does not exist, the controller will wait to start the
provisioning of the BareMetalHost until it exists.</p>
<h3><a class="header" href="#dynamic-secret-creation" id="dynamic-secret-creation">Dynamic secret creation</a></h3>
<p>In the case where the Metal3Machine is created with a <code>dataTemplate</code> value, the
Metal3Machine reconciler will create a <em>Metal3DataClaim</em> for that object.</p>
<p>The <em>Metal3DataClaim</em> would then be reconciled, and its controller will create
an index for this <em>Metal3DataClaim</em> if it does not exist yet, and create a
Metal3Data object with the index. Upon success, it will set the <em>ready</em> field
to true, and the <em>renderedData</em> field to reference the <em>Metal3Data</em> object.</p>
<p>The Metal3Data reconciler will then generate the secrets, based on the index,
the Metal3DataTemplate and the machine. Once created, it will set the status
field <code>ready</code> to True.</p>
<p>Once the Metal3Data object is ready, the Metal3Machine controller will fetch
the secrets that have been created (one or both) and use them to start
provisioning the BareMetalHost.</p>
<h3><a class="header" href="#hybrid-configuration" id="hybrid-configuration">Hybrid configuration</a></h3>
<p>If the Metal3Machine object is created with a <code>dataTemplate</code> field set, but one
of the <code>metaData</code> or <code>networkData</code> is also set in the spec, this one will
override the template generation for this specific secret. i.e. if the user sets
the three fields, the controller will use the user input secret for both.</p>
<p>This means that some hybrid scenarios are supported, where the user can give
directly the <code>metaData</code> secret and let the controller render the <code>networkData</code>
secret through the Metal3DataTemplate object.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../developer/controllers/Metal3DataClaim.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../developer/relational_diagram.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../developer/controllers/Metal3DataClaim.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../developer/relational_diagram.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
